<prizm-dropdown-host
    class="z-hosted"
    [canOpen]="canOpen"
    [content]="dropdown"
    [closeByEsc]='true'
    [isOpen]="open && canOpen"
    (isOpenChange)="onOpenChange($event)"
    prizmDropdownHostWidth='auto'
>
  <prizm-input-layout
    [label]="label"
    [outer]='outer'
    [size]="size">
    <input
      class='input-search'
      prizmInput
      #focusableElementRef
      [mask]="computedMask"
      [showMaskTyped]='focusableElementRef.focused'
      [dropSpecialCharacters]="false"
      [readOnly]="readOnly"
      [placeholder]='placeholder'
      [disabled]="computedDisabled"
      [ngModel]="stringValue"
      (ngModelChange)='onValueChange($event || "")'
    />

    <ng-container prizm-input-right>
      <button
        prizmInputIconButton="date-calendar-range"
        [interactive]="true"
        (click)='focusableElementRef.focus()'></button>
    </ng-container>
  </prizm-input-layout>
  <ng-template #dropdown let-zone="zone">
      <prizm-calendar-range
          [style.--prizm-input-layout-width]="'100%'"
          [style.--prizm-dropdown-host-width]="'100%'"
          [defaultViewedMonth]="defaultViewedMonth"
          [disabledItemHandler]="disabledItemHandler"
          [items]="items"
          [min]="min"
          [max]="max"
          [markerHandler]="markerHandler"
          [minLength]="minLength"
          [maxLength]="maxLength"
          [value]="value"
          (valueChange)="onRangeChange($event)"
      >
        <ng-container footerFrom>
          <ng-template
            [ngTemplateOutlet]="footerToTemplate"
            [ngTemplateOutletContext]="{ zone: zone }">
          ></ng-template>
        </ng-container>
        <ng-container footerTo>
          <ng-template
            [ngTemplateOutlet]="footerFromTemplate"
            [ngTemplateOutletContext]="{ zone: zone }">
            ></ng-template>
        </ng-container>
      </prizm-calendar-range>
  </ng-template>
</prizm-dropdown-host>

<ng-template #footerToTemplate let-zone="zone">
  <prizm-input-time
    [prizmEventZoneParent]='zone'
    [style.--prizm-dropdown-host-width]='"100%"'
    [ngModel]='value?.timeRange?.from'
    (ngModelChange)='updateTime(false, $event)'
    [mode]='timeMode'>
  </prizm-input-time>
</ng-template>

<ng-template #footerFromTemplate let-zone="zone">
  <prizm-input-time
    [prizmEventZoneParent]='zone'
    [style.--prizm-dropdown-host-width]='"100%"'
    [ngModel]='value?.timeRange?.to'
    (ngModelChange)='updateTime(true, $event)'
    [mode]='timeMode'>
  </prizm-input-time>
</ng-template>
