import { Meta, Story, Canvas, ArgsTable, ColorPalette, ColorItem, Preview, Typeset } from '@storybook/addon-docs/blocks';
import { moduleMetadata } from '@storybook/angular';
import { storiesOf } from '@storybook/angular';

import {
  Title,
  Subtitle,
  Description,
} from '@storybook/addon-docs/blocks';

## Zyfra - Dynamic Dialog

<Subtitle>Dialogs can be created dynamically with any component as the content using a DialogService.</Subtitle>

Import module:

```typescript
import { ZyfraDynamicDialogModule, ZyfraButtonModule } from '@digital-plant/zyfra-components';

@NgModule({
  imports: [ZyfraDynamicDialogModule, ZyfraButtonModule],
})
export class YourModule {}
```

To component:

```typescript
import { Component, Input, OnInit } from '@angular/core';
import { takeUntil } from 'rxjs/operators';
import { ZyfraDynamicDialogService } from 'zyfra-dynamic-dialog';

@Component({
  template: `
  <zyfra-button (click)="open()"
                label="open dialog"
                icon="pi pi-check"></zyfra-button>
  `,
  providers: [ZyfraDynamicDialogService]
})

export default class ZyfraDynamicDialogDemo implements OnDestroy {

  private ref: ZyfraDynamicDialogRef;
  private destroyed$: Subject<void> = new Subject();

  constructor(private dynamicDialogService: ZyfraDynamicDialogService) { }

  public open(): void {
    this.ref = this.dynamicDialogService.open(
      ExapleDynamicDialogComponent, {
        header: 'Demo Dynamic Dialog',
        width: '70%',
        data: 'some data'
    })

    this.ref.onClose.pipe(
      takeUntil(this.destroyed$)
    ).subscribe(() => {
      //dialog close event
    });

    this.ref.onDestroy.pipe(
      takeUntil(this.destroyed$)
    ).subscribe(() => {
      //dialog destroy event
    });
  }

  public ngOnDestroy(): void {
      if (this.ref) {
          this.ref.close();
      }
      
      this.destroyed$.next();
      this.destroyed$.complete();
  }
}
```

Template component:
```typescript
import { ZyfraDynamicDialogService } from '@digital-plant/zyfra-components';

  @Component({
  template: `This your template`
})
export class ExampleDynamicDialogComponent implements ngOnInit {

  constructor(public dynamicDialogService: ZyfraDynamicDialogService) {

  public ngOnInit(): void {
    //get this.dynamicDialogService.config
  }

  public closeDialog(): void {
    this.dynamicDialogService.ref.close(/*set some user data*/);
  }
}
```
